!function(e){function o(o){"use strict";var i=e(o),n=["powermail_input","powermail_textarea","powermail_select","powermail_radio","powermail_checkbox"];this.ajaxListener=function(){t(),e(y()).on("change",function(){t()})};var r=function(o){if(void 0!==o.todo){for(var i in o.todo){var n=e(".powermail_form_"+i);for(var r in o.todo[i]){n.find(".powermail_fieldset_"+r);"hide"===o.todo[i][r]["#action"]&&f(m(r,n)),"un_hide"===o.todo[i][r]["#action"]&&c(m(r,n));for(var t in o.todo[i][r])"hide"===o.todo[i][r][t]["#action"]&&p(t,n),"un_hide"===o.todo[i][r][t]["#action"]&&u(t,n)}}h()}},t=function(){var o=e(i.get(0)),n=o.find(":disabled").prop("disabled",!1),t=new FormData(i.get(0));t.find('input[type="file"]').map(function(e,o){t["delete"]&&t["delete"](o.name)}),n.prop("disabled",!0),e.ajax({type:"POST",url:l(),data:t,contentType:!1,processData:!1,success:function(e){100===e.loops&&q("100 loops reached by parsing conditions and rules. Maybe there are conflicting conditions."),r(e)}})},a=function(e){(e.prop("required")||e.data("parsley-required"))&&(e.prop("required",!1),e.removeAttr("data-parsley-required"),e.data("powermailcond-required","required"))},d=function(e){"required"===e.data("powermailcond-required")&&(v()?e.prop("required","required"):_()&&e.prop("required","required")),e.removeData("powermailcond-required")},u=function(e,o){var i=o.find(".powermail_fieldwrap_"+e);i.show();var n=s(e,o);n.prop("disabled",!1),d(n)},p=function(e,o){var i=o.find(".powermail_fieldwrap_"+e);i.hide();var n=s(e,o);n.prop("disabled",!0),a(n)},c=function(e){e.show()},f=function(e){e.hide()},l=function(){var o=e("*[data-condition-uri]").data("condition-uri");return void 0===o&&q("Tag with data-condition-uri not found. Maybe TypoScript was not included."),o},s=function(e,o){return o.find('[name^="tx_powermail_pi1[field]['+e+']"]').not('[type="hidden"]')},m=function(e,o){return o.find(".powermail_fieldset_"+e)},w=function(e,o,i){o="undefined"!=typeof o?o:"",i="undefined"!=typeof i?i:",";for(var n="",r=0;r<e.length;r++)r>0&&(n+=i),n+=o+e[r];return n},y=function(){return w(n,".")},_=function(){return"data-parsley-validate"===i.data("parsley-validate")},v=function(){return"html5"===i.data("validate")},h=function(){_()&&(i.parsley().destroy(),i.parsley())},q=function(e){"object"==typeof console&&("string"==typeof e&&(e="powermail_cond: "+e),console.log(e))}}e(document).ready(function(){e("form.powermail_form").each(function(){new o(this).ajaxListener()})})}(jQuery);