!function(_){function o(o){"use strict";var i=_(o),e=["powermail_input","powermail_textarea","powermail_select","powermail_radio","powermail_checkbox"];this.ajaxListener=function(){r(),_(f()).on("change",function(){r()})};var r=function(){var o=_(i.get(0)).find(":disabled").prop("disabled",!1),e=new FormData(i.get(0));o.prop("disabled",!0),_.ajax({type:"POST",url:n(),data:e,contentType:!1,processData:!1,success:function(o){100===o.loops&&w("100 loops reached by parsing conditions and rules. Maybe there are conflicting conditions."),function(o){if(void 0!==o.todo){for(var e in o.todo){var i,r=_(".powermail_form_"+e);for(i in o.todo[e]){r.find(".powermail_fieldset_"+i);for(var n in"hide"===o.todo[e][i]["#action"]&&c(p(i,r)),"un_hide"===o.todo[e][i]["#action"]&&d(p(i,r)),o.todo[e][i])"hide"===o.todo[e][i][n]["#action"]&&a(n,r),"un_hide"===o.todo[e][i][n]["#action"]&&t(n,r)}}m()}}(o)}})},t=function(o,e){e.find(".powermail_fieldwrap_"+o).show();e=u(o,e);e.prop("disabled",!1),"required"===(e=e).data("powermailcond-required")&&(s()||l())&&e.prop("required","required"),e.removeData("powermailcond-required")},a=function(o,e){e.find(".powermail_fieldwrap_"+o).hide();e=u(o,e);e.prop("disabled",!0),((e=e).prop("required")||e.data("parsley-required"))&&(e.prop("required",!1),e.removeAttr("data-parsley-required"),e.data("powermailcond-required","required"))},d=function(o){o.show()},c=function(o){o.hide()},n=function(){var o=_("*[data-condition-uri]").data("condition-uri");return void 0===o&&w("Tag with data-condition-uri not found. Maybe TypoScript was not included."),o},u=function(o,e){return e.find('[name^="tx_powermail_pi1[field]['+o+']"]').not('[type="hidden"]')},p=function(o,e){return e.find(".powermail_fieldset_"+o)},f=function(){return function(o,e,i){e=void 0!==e?e:"",i=void 0!==i?i:",";for(var r="",n=0;n<o.length;n++)0<n&&(r+=i),r+=e+o[n];return r}(e,".")},l=function(){return"data-parsley-validate"===i.data("parsley-validate")},s=function(){return"html5"===i.data("validate")},m=function(){l()&&(i.parsley().destroy(),i.parsley())},w=function(o){"object"==typeof console&&("string"==typeof o&&(o="powermail_cond: "+o),console.log(o))}}_(document).ready(function(){_("form.powermail_form").each(function(){new o(this).ajaxListener()})}),_(".tx-powermail").on("submitted.powermail.form",function(){_("form.powermail_form").each(function(){new o(this).ajaxListener()})})}(jQuery);